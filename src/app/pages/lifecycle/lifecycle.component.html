<div class="lifecycle-container">
  <div class="lifecycle-header">
    <h1>ğŸ”„ Angular Lifecycle Hooks</h1>
    <p>Component Lifecycle vÃ  Change Detection</p>
  </div>

  <!-- Lifecycle Order Diagram -->
  <section class="lifecycle-section">
    <h2>ğŸ“Š Thá»© tá»± Lifecycle Hooks</h2>
    <div class="lifecycle-diagram">
      <div
        class="hook-card"
        *ngFor="let hook of lifecycleHooks"
        [style.border-left-color]="hook.color"
      >
        <div class="hook-header">
          <span class="hook-order" [style.background]="hook.color">{{ hook.order }}</span>
          <span class="hook-name">{{ hook.name }}</span>
        </div>
        <div class="hook-timing">â° {{ hook.timing }}</div>
        <div class="hook-description">{{ hook.description }}</div>
        <div class="hook-usage">
          <strong>Use case:</strong>
          {{ hook.usage }}
        </div>
      </div>
    </div>
  </section>

  <!-- Interactive Demo -->
  <section class="lifecycle-section">
    <h2>ğŸ® Interactive Demo</h2>
    <p class="section-desc">
      Thá»­ cÃ¡c actions bÃªn dÆ°á»›i vÃ  xem console log / logs Ä‘á»ƒ tháº¥y lifecycle hooks Ä‘Æ°á»£c gá»i
    </p>

    <div class="demo-area">
      <!-- Controls -->
      <div class="demo-controls">
        <h3>ğŸ›ï¸ Controls</h3>
        <div class="control-buttons">
          <button class="btn-primary" (click)="incrementCounter()">
            â• Increment Counter ({{ counter }})
          </button>
          <button class="btn-primary" (click)="updateData()">ğŸ”„ Update Data</button>
          <button class="btn-warning" (click)="toggleChild()">
            {{ showChild ? 'âŒ Destroy Child' : 'âœ¨ Create Child' }}
          </button>
          <button class="btn-secondary" (click)="startAutoIncrement()">
            {{ intervalId ? 'â¸ï¸ Stop Auto' : 'â–¶ï¸ Auto Increment' }}
          </button>
          <button class="btn-danger" (click)="clearLogs()">ğŸ—‘ï¸ Clear Logs</button>
        </div>

        <div class="demo-info">
          <div class="info-item">
            <span class="info-label">Counter:</span>
            <span class="info-value">{{ counter }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Child Data:</span>
            <span class="info-value">{{ childData }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Child Status:</span>
            <span class="info-value" [class.active]="showChild" [class.inactive]="!showChild">
              {{ showChild ? 'âœ“ Active' : 'âœ— Destroyed' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Child Component -->
      <div class="demo-child">
        <h3>ğŸ‘¨â€ğŸ‘¦ Parent-Child Relationship</h3>

        <div class="parent-box">
          <h4>ğŸ‘¨ Parent Component</h4>
          <p>Truyá»n data qua &#64;Input bindings</p>
          <code>[counter]="{{ counter }}" [data]="{{ childData }}"</code>

          <app-lifecycle-child *ngIf="showChild" [counter]="counter" [data]="childData">
            <p style="color: #666; margin: 0">ğŸ“¦ This is projected content (ng-content)</p>
          </app-lifecycle-child>

          <div *ngIf="!showChild" class="no-child">
            <p>âš ï¸ Child component Ä‘Ã£ bá»‹ destroy</p>
            <p>Click "Create Child" Ä‘á»ƒ táº¡o láº¡i</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Logs -->
  <section class="lifecycle-section">
    <h2>ğŸ“ Lifecycle Logs</h2>
    <div class="logs-container">
      <div class="log-header">
        <span>Time</span>
        <span>Component</span>
        <span>Hook</span>
        <span>Message</span>
      </div>
      <div class="logs-list">
        <div
          class="log-entry"
          *ngFor="let log of logs; trackBy: trackByIndex"
          [class.parent-log]="log.component === 'parent'"
          [class.child-log]="log.component === 'child'"
        >
          <span class="log-time">{{ log.timestamp | date: 'HH:mm:ss.SSS' }}</span>
          <span class="log-component">{{ log.component }}</span>
          <span class="log-hook">{{ log.hook }}</span>
          <span class="log-message">{{ log.message }}</span>
        </div>
        <div *ngIf="logs.length === 0" class="no-logs">
          <p>KhÃ´ng cÃ³ logs. Thá»­ click cÃ¡c buttons Ä‘á»ƒ trigger lifecycle hooks!</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Best Practices -->
  <section class="lifecycle-section">
    <div class="best-practices">
      <h3>ğŸ’¡ Best Practices</h3>
      <div class="practice-grid">
        <div class="practice-card do">
          <h4>âœ“ DO</h4>
          <ul>
            <li>
              <strong>ngOnInit:</strong>
              Initialize component, fetch data, setup subscriptions
            </li>
            <li>
              <strong>ngOnDestroy:</strong>
              Always cleanup: unsubscribe, clear timers, remove event listeners
            </li>
            <li>
              <strong>ngOnChanges:</strong>
              Validate &#64;Input changes, reset state if needed
            </li>
            <li>
              <strong>constructor:</strong>
              Chá»‰ inject dependencies, khÃ´ng gá»i APIs
            </li>
            <li>
              <strong>ngAfterViewInit:</strong>
              Access ViewChild/ViewChildren, DOM operations
            </li>
          </ul>
        </div>

        <div class="practice-card dont">
          <h4>âœ— DON'T</h4>
          <ul>
            <li>
              <strong>constructor:</strong>
              KhÃ´ng fetch data, khÃ´ng cÃ³ side effects
            </li>
            <li>
              <strong>ngDoCheck:</strong>
              TrÃ¡nh heavy operations, cháº¡y ráº¥t thÆ°á»ng xuyÃªn
            </li>
            <li>
              <strong>ngAfterViewChecked:</strong>
              KhÃ´ng thay Ä‘á»•i data, sáº½ gÃ¢y ExpressionChangedAfterItHasBeenCheckedError
            </li>
            <li>
              <strong>ngOnDestroy:</strong>
              KhÃ´ng quÃªn cleanup, sáº½ gÃ¢y memory leaks
            </li>
            <li>KhÃ´ng dÃ¹ng quÃ¡ nhiá»u lifecycle hooks náº¿u khÃ´ng cáº§n thiáº¿t</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Common Use Cases -->
  <section class="lifecycle-section">
    <div class="use-cases">
      <h3>ğŸ¯ Common Use Cases</h3>
      <div class="usecase-grid">
        <div class="usecase-card">
          <h4>Fetch Data</h4>
          <pre><code>ngOnInit() {{'{'}}{{'}'}}
  this.service.getData()
    .subscribe(data => {{'{'}}
      this.data = data;
    {{'}'}});
{{'}'}}</code></pre>
        </div>

        <div class="usecase-card">
          <h4>Cleanup Subscription</h4>
          <pre><code>ngOnDestroy() {{'{'}}{{'}'}}
  this.subscription?.unsubscribe();
  clearInterval(this.timer);
{{'}'}}</code></pre>
        </div>

        <div class="usecase-card">
          <h4>Access ViewChild</h4>
          <pre><code>ngAfterViewInit() {{'{'}}{{'}'}}
  this.myChild.doSomething();
  this.element.nativeElement.focus();
{{'}'}}</code></pre>
        </div>

        <div class="usecase-card">
          <h4>React to Input Changes</h4>
          <pre><code>ngOnChanges(changes: SimpleChanges) {{'{'}}{{'}'}}
  if (changes['userId']) {{'{'}}
    this.loadUserData();
  {{'}'}}
{{'}'}}</code></pre>
        </div>
      </div>
    </div>
  </section>

  <!-- Tips -->
  <section class="lifecycle-section">
    <div class="tips-box">
      <h3>ğŸ’¡ Tips & Tricks</h3>
      <ul>
        <li>
          ğŸ”
          <strong>Open DevTools Console</strong>
          Ä‘á»ƒ xem detailed logs cá»§a lifecycle hooks
        </li>
        <li>
          â±ï¸
          <strong>ngDoCheck</strong>
          vÃ 
          <strong>ngAfterContentChecked</strong>
          ,
          <strong>ngAfterViewChecked</strong>
          cháº¡y ráº¥t thÆ°á»ng xuyÃªn - trÃ¡nh heavy operations
        </li>
        <li>
          ğŸ§¹
          <strong>Always cleanup</strong>
          trong ngOnDestroy Ä‘á»ƒ trÃ¡nh memory leaks
        </li>
        <li>
          ğŸ¯
          <strong>Use async pipe</strong>
          khi cÃ³ thá»ƒ - tá»± Ä‘á»™ng unsubscribe
        </li>
        <li>
          ğŸ“¦
          <strong>ngOnChanges</strong>
          chá»‰ detect reference changes, khÃ´ng detect deep object changes
        </li>
        <li>âš¡ Constructor nÃªn nháº¹ - complex logic nÃªn Ä‘á»ƒ trong ngOnInit</li>
      </ul>
    </div>
  </section>
</div>
